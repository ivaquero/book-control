#import "lib/sci-book.typ": *
#show: doc => conf(
  title: "çº¿æ€§äºŒæ¬¡å‹è°ƒèŠ‚å™¨",
  author: ("ivaquero"),
  header-cap: "ç°ä»£æ§åˆ¶ç†è®º",
  footer-cap: "github@ivaquero",
  outline-on: false,
  doc,
)

= ä¸€ç»´åŠ¨æ€è§„åˆ’

== ç®€å•ç³»ç»Ÿ

è€ƒè™‘ç³»ç»Ÿ

$ x_([k+1]) = x_([k]) + u_([k]) $

å…¶ä¸­

- åˆå§‹å€¼ï¼š$x[0]=1$
- ç›®æ ‡å€¼ï¼š$x[d]=0$
- æœ«ç«¯ï¼š$N=2$

äºæ˜¯ï¼Œå…¶ä»£ä»·å‡½æ•°å¯å®šä¹‰ä¸º

$
  J = 1 / 2 underbrace(x^2[w], "æœ«ç«¯ä»£ä»·") + 1 / 2 âˆ‘_(k=0)^(N-1)(
    underbrace(x^2_([k]),"è¿è¡Œä»£ä»·") + underbrace(u^2_([k]), "è¾“å…¥ä»£ä»·")
  )
$

== æç«¯ç­–ç•¥

#block(
  height: 11em,
  columns()[
    - ç­–ç•¥1ï¼šä¸€æ­¥åˆ°ä½
      - è¾“å…¥ä»£ä»·
        - $u[0] = -1$
        - $u[1] = 0$
      - æœ€ç»ˆä»£ä»·
        - $x[1] = 0, x[2] = 0$
        - $J = 1$
    - ç­–ç•¥2ï¼šä¸¤æ­¥èµ°
      - è¾“å…¥ä»£ä»·
        - $u[0] = -0.5$
        - $u[1] = -0.5$
      - æœ€ç»ˆä»£ä»·
        - $x[1] = 0.5, x[2] = 0$
        - $J = 0.875$
  ],
)

== æœ€ä¼˜ç­–ç•¥

å³ï¼Œæ±‚$u^*[0], u^*[1]$ï¼Œä½¿$J$æœ€å°ï¼Œé‡‡ç”¨é€†å‘åˆ†çº§æ–¹æ³•

- $k = 1â†’2$

$
  J_(1â†’2) &= 1 / 2 x^2[2] + 1 / 2 x^2[1] + 1 / 2 u^2[1]\
  &= 1 / 2 (x[1] + u[1])^2 + 1 / 2 x^2[1] + 1 / 2 u^2[1]
$

æ±‚å¯¼å¾—

$ pdv(J_(1â†’2),u[1]) = x[1] + u[1] + u[1] = 0 $

æœ‰

$ u^*[1] = -1 / 2 x[1] $

äºæ˜¯

$ J^*_(1â†’2) = 3 / 4 x^2[1] $

è¿›è€Œå¾—

$ J_(0â†’2) = J_(1â†’2) + 1 / 2(x^2[0] + u^2[0]) $

æ ¹æ® Bellman æœ€ä¼˜ç†è®ºï¼Œè‹¥$J_(0â†’2)$æœ€å°ï¼Œåˆ™å­é¡¹$J_(1â†’2)$æ­¤æ—¶å¿…ä¸º æœ€å°ã€‚ä»£å…¥$J^*_(1â†’2)$å’Œ$x[1]$ï¼Œå¯å¾—

$ J_(0â†’2) = 3 / 4 (x[0] + u[0])^2 + 1 / 2 (x^2[0] + u^2[0]) $

æ±‚å¯¼å¾—

$ pdv(J_(0â†’2),u[0]) = 3 / 2 (x[0] + u[0]) + u[0] = 0 $

æ­¤æ—¶

$ u^*[0] = -3 / 5 x[0] $

å›ä»£å¾—

$ x[0] = 2 / 5, x[1] = 1 / 5 $

æœ€ç»ˆå¾—

$ J_(min) = 0.8 $

= çº¿æ€§äºŒæ¬¡å‹è°ƒèŠ‚å™¨

== çº¿æ€§ç³»ç»Ÿ

å¯¹ç¦»æ•£çº¿æ€§ç³»ç»Ÿ

$ ğ’™_([k+1]) = ğ‘¨ ğ’™_([k]) + ğ‘© ğ’–_([k]) $ <sys>

å…¶ä»£ä»·å‡½æ•°å¯åŒ–ä¸ºäºŒæ¬¡å‹

$
  J &= 1 / 2 underbrace((ğ’™_([N]) - ğ’™_d_([N]))^(âŠ¤) ğ‘º(ğ’™_([N]) - ğ’™[d]), "æœ«ç«¯ä»£ä»·") \
  &+1 / 2âˆ‘_(k=0)^(N-1) (underbrace((ğ’™_([N]) - ğ’™[d])^(âŠ¤) ğ‘¸ (ğ’™_([N]) - ğ’™[d])^(âŠ¤), "è¿è¡Œä»£ä»·") + ğ’–^(âŠ¤)_([k]) ğ‘¹ ğ’–_([k]))
$

è°ƒèŠ‚ç›®æ ‡

$ ğ’™_d = ğŸ = vec(delim: "[", 0, 0, â‹®,0) $

åˆ™

$ J = 1 / 2 ğ’™_([N])^(âŠ¤) ğ‘º ğ’™_([N]) + 1 / 2 âˆ‘_k^(N-1) (ğ’™_([k])^(âŠ¤) ğ‘¸ ğ’™_([k]) + ğ’–^(âŠ¤)_([k]) ğ‘¹ ğ’–_([k])) $

è¿™å°±å¾—åˆ°äº†ä¸€ä¸ª LQRï¼ˆlinear quadratic regulatorï¼‰é—®é¢˜ã€‚æ­¤æ—¶ï¼Œ$ğ‘º, ğ‘¸$ä¸ºåŠæ­£å®šå¯¹è§’é˜µï¼Œ$ğ‘¹$ä¸ºæ­£å®šå¯¹è§’é˜µã€‚

#pagebreak(weak: true)

== é€†å‘åˆ†çº§

$k = N$æ—¶

$ J_(Nâ†’N) = 1 / 2 ğ’™_([N])^(âŠ¤) ğ‘º ğ’™_([N]) $

æ­¤æ—¶$J$ä¸ºæœ€ä¼˜æœ«ç«¯ä»£ä»·ï¼Œå› ä¸ºæ­¤æ—¶æ— æ³•å†äº§ç”Ÿå˜åŒ–ã€‚ä»¤$ğ‘º = P_([0])$ï¼Œå³

$ J_(Nâ†’N) = 1 / 2 ğ’™_([N])^(âŠ¤) P_([0]) ğ’™_([N]) $

$k = N-1$æ—¶

$
  J_(N-1â†’N) &= 1 / 2 ğ’™_([N])^(âŠ¤) ğ‘º ğ’™_([N]) + 1 / 2 ğ’™_([N-1])^(âŠ¤) ğ‘¸ ğ’™_([N-1]) + 1 / 2 ğ’–^(âŠ¤)_([N-1]) ğ‘¹ ğ’–_([N-1])\
  &= J_(Nâ†’N) + 1 / 2 ğ’™_([N-1])^(âŠ¤) ğ‘¸ ğ’™_([N-1]) + 1 / 2 ğ’–^(âŠ¤)_([N-1]) ğ‘¹ ğ’–_([N-1])
$

ä»¥æ­¤ç±»æ¨

$
  J_(N-2â†’N) = J_(N-1â†’N) + 1 / 2 ğ’™_([N-2])^(âŠ¤) ğ‘¸ ğ’™_([N-2]) + 1 / 2 ğ’–^(âŠ¤)_([N-2]) ğ‘¹ ğ’–_([N-2])
$

åˆç”±@sysï¼Œå¯å¾—

$ ğ’™_([N]) = ğ‘¨ ğ’™_([N-1]) + ğ‘© ğ’–_([N-1]) $

äºæ˜¯ï¼Œä»¤ä¸€é˜¶å¯¼æ•°

$ pdv(J_(N-1â†’N), ğ’–_([N-1])) = 0 $

å¾—

$
  ğ’–^*_([N-1]) &= -(ğ‘©^âŠ¤ P_([0])ğ‘© + ğ‘¹)^(-1) ğ‘©^âŠ¤ P_([0]) ğ‘¨ ğ’™_([N-1])\
  &= -underbrace(F_([N-1]), "feedback")underbrace(ğ’™_([N-1]),"Gain")
$

åˆäºŒé˜¶å¯¼æ•°

$ pdv(J_(N-1â†’N), ğ’–_([N-1]), 2) = underbrace((ğ‘©^âŠ¤ P_([0])ğ‘©)^âŠ¤, "â‰¥0") + underbrace(ğ‘¹^âŠ¤, ">0") $

æ•…$ğ’–^*$ä¸ºæœ€å°å€¼ã€‚è¿›ä¸€æ­¥å¾—

$ J_(N-1â†’N) = 1 / 2 ğ’™_([N-1])^(âŠ¤) P_([1]) ğ’™_([N-1]) $

å…¶ä¸­

$ P_([1]) = (ğ‘¨ - ğ‘© F_([N-1]))^âŠ¤ P_([0])(ğ‘¨ - ğ‘© F_([N-1])) + F_([N-1])^âŠ¤ ğ‘¹ F_([N-1]) + ğ‘¸ $

ç±»æ¨å¾—

$ J_(N-kâ†’N) = 1 / 2 ğ’™_([N-1])^(âŠ¤) P_([k]) ğ’™_([N-1]) $

å…¶ä¸­

$
  cases(
    P_([k]) = (ğ‘¨ - ğ‘© F_([N-k]))^âŠ¤ P_([k-1])(ğ‘¨ - ğ‘© F_([N-k])) + F_([N-k])^âŠ¤ ğ‘¹ F_([N-k]) + ğ‘¸,
    F_([N-k]) = (ğ‘©^âŠ¤ P_([0])ğ‘© + ğ‘¹)^(-1) ğ‘©^âŠ¤ P_([k-1]) ğ‘¨,
    ğ’–^*_([N-k]) = -F_([N-k]) ğ’™_([N-k])
)
$

= è½¨è¿¹è¿½è¸ª

== å¼¹ç°§æŒ¯åŠ¨é˜»å°¼ç³»ç»Ÿ

å¯¹å¼¹ç°§æŒ¯åŠ¨é˜»å°¼ç³»ç»Ÿ

#figure(
  image("images/model/vibration.drawio.png", width: 40%),
  caption: "",
  supplement: [å›¾],
)

- å½“ç›®æ ‡$ğ’™_d = vec(delim: "[", 0, 0)$ï¼Œä¸ºç»å…¸ LQR é—®é¢˜
- å½“ç›®æ ‡$ğ’™_d = vec(delim: "[", 1, 0)$æˆ–ä¸ä¸º$ğŸ$æ—¶ï¼Œä¸ºè½¨è¿¹è¿½è¸ªé—®é¢˜

è‹¥è¿½è¸ªç›®æ ‡ä¸º

$ ğ’™_(d[k+1]) = ğ‘¨_D ğ’™_(d[k]) $

è®¾$ğ’™_d$ä¸ºå¸¸æ•°å‘é‡ï¼Œåˆ™ä»¤

$ ğ’†_([k]) = ğ’™_([k]) - ğ’™_(d[k]) = underbrace([ğ‘° -ğ‘°], "ğ‘ªâ‚") vec(delim: "[", ğ’™_([k]), ğ’™_(d[k])) $

æ­¤æ—¶ï¼Œç›®æ ‡å€¼$ğ’†_(d[k]) = 0$ï¼Œé—®é¢˜è½¬åŒ–ä¸º LQR é—®é¢˜ã€‚äºæ˜¯æœ‰

$
  underbrace(vec(delim: "[", ğ’™_([k+1]), ğ’™_(d[k+1])), "ğ’™â‚[k+1]") = underbrace(dmat(delim: "[", ğ‘¨, ğ‘¨_0), "ğ‘¨â‚") underbrace(vec(delim: "[", ğ’™_([k]), ğ’™_(d[k])), "ğ’™â‚[k]") + underbrace(vec(delim: "[", ğ‘©, ğŸ), "ğ‘©â‚") ğ’–
$

è¿›ä¸€æ­¥æœ‰

$ ğ’†_([k]) = ğ‘ª_a ğ’™_(a[k]) $

å¯¹åº”çš„ä»£ä»·å‡½æ•°ä¸º

$
  J &= 1 / 2 ğ’†^(âŠ¤)_([N]) ğ‘º ğ’†_([N]) + 1 / 2 âˆ‘_(k=0)^(N-1) (ğ’†^(âŠ¤)_([k]) ğ‘¸ ğ’†_([k]) + ğ’–^(âŠ¤)_([k]) ğ‘¹ ğ’–_([k]))\
  &= 1 / 2 (ğ‘ª_a ğ’™_(a[k]))^(âŠ¤)_([N]) ğ‘º (ğ‘ª_a ğ’™_(a[k])) + 1 / 2 âˆ‘_(k=0)^(N-1) (
    (ğ‘ª_a ğ’™_(a[k]))^(âŠ¤)_([k]) ğ‘¸ (ğ‘ª_a ğ’™_(a[k]))_([k]) + ğ’–^(âŠ¤)_([k]) ğ‘¹ ğ’–_([k])
  )\
  &= 1 / 2 ğ’™_(a[k])^(âŠ¤) ğ‘º_a ğ’™_(a[k]) + 1 / 2 âˆ‘_(k=0)^(N-1) (ğ’™_(a[k])^(âŠ¤) ğ‘¸_a ğ’™_(a[k]) + ğ’–^(âŠ¤)_([k]) ğ‘¹ ğ’–_([k]))
$ <cost>

ä¸Šå¼æˆåŠŸå°†è¿½è¸ªé—®é¢˜è½¬åŒ–ä¸ºäº† LQR é—®é¢˜ã€‚ä½†å½“$ğ‘¹$è¿‡å¤§ï¼Œåˆ™ç³»ç»Ÿå°†èººå¹³ï¼Œæ— æ³•è¿›è¡Œè¿½è¸ªã€‚

== éé›¶å¸¸æ•°ç¨³æ€

è€ƒè™‘ç‰¹ä¾‹ï¼Œå¦‚æ’æ¸©æˆ–åŒ€é€Ÿæ§åˆ¶ï¼Œæ­¤æ—¶

$ ğ’™_(d[k]) = ğ’™_d $

ä¸”$ğ’™_d$å¤„ï¼Œç³»ç»Ÿå¤„äºç¨³æ€ï¼Œå³è¾“å…¥$ğ’–$ä½¿ç³»ç»Ÿæ€»èƒ½å¾—åˆ°$ğ’™_d$ã€‚äºæ˜¯

$ ğ’™_d = ğ‘¨ ğ’™_d + ğ‘© ğ’–_d $

å¯å¾—

$ (ğ‘° - ğ‘¨)ğ’™_d = ğ‘© ğ’–_d $

å®šä¹‰ç¨³æ€è¯¯å·®

$ Î´ ğ’–_([k]) = ğ’–_([k]) - ğ’–_([d]) $

ä»£å…¥@sysï¼Œå¯å¾—

$
  ğ’™_([k+1]) &= ğ‘¨ ğ’™_([k]) + ğ‘©(Î´ ğ’–_([k]) + ğ’–_([d])) \
  &= ğ‘¨ ğ’™_([k]) + ğ‘© Î´ ğ’–_([k]) + (ğ‘° - ğ‘¨) ğ’™_d
$

æ„é€ å¢å¹¿çŸ©é˜µ

$
  ğ’™_(a[
    k+1
  ]) = vec(delim: "[", ğ’™_([k+1]), ğ’™_d) = underbrace(mat(delim: "[", ğ‘¨, ğ‘° - ğ‘¨; ğŸ, ğ‘°), "ğ‘¨â‚") vec(delim: "[", ğ’™_([k]), ğ’™_d) + underbrace(vec(delim: "[", ğ‘©, ğŸ), "ğ‘©â‚") Î´ ğ’–_([
    k
  ])
$

ä»¤

$ ğ’†_([k]) = ğ’™_([k]) - ğ’™_d = underbrace((ğ‘° - ğ‘¨), "ğ‘ªâ‚") underbrace(vec(delim: "[", ğ’™_([k]), ğ’™_d), "ğ’™â‚[k]") $

ä»£å…¥@costï¼Œå¾—

$
  J &= 1 / 2 ğ’™^(âŠ¤)_(a[N]) ğ‘ª^(âŠ¤)_a ğ‘º_a ğ‘ª_a ğ’™_(a[N]) + 1 / 2 âˆ‘_(k=0)^(N-1) (
    ğ’™^(âŠ¤)_(a[k]) ğ‘ª^(âŠ¤)_a ğ‘¸_a ğ‘ª_a ğ’™_(a[k]) + Î´ ğ’–^(âŠ¤)_([k]) ğ‘¹ Î´ ğ’–_([k])
  )
$

è¿™å°±å¾—åˆ°äº†ä¸€ä¸ªæ–°çš„ LQR é—®é¢˜ã€‚

#figure(
  image("images/block/lqr-tracking.drawio.png", width: 40%),
  caption: "è½¨è¿¹è¿½è¸ª LQR ç³»ç»Ÿ",
  supplement: [å›¾],
)

== éé›¶å˜åŒ–ç¨³æ€
