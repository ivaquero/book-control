#import "lib/sci-book.typ": *
#show: doc => conf(
  title: "线性二次型调节器",
  author: ("ivaquero"),
  header-cap: "现代控制理论",
  footer-cap: "github@ivaquero",
  outline-on: false,
  doc,
)

= 一维动态规划

== 简单系统

考虑系统

$ x[k+1] = x[k] + u[k] $

其中

- 初始值：$x[0]=1$
- 目标值：$x[d]=0$
- 末端：$N=2$

于是，其代价函数可定义为

$
  J = 1 / 2 underbrace(x^2[w], "末端代价") + 1 / 2 ∑_(k=0)^(N-1)(
    underbrace(x^2[k],"运行代价") + underbrace(u^2[k], "输入代价")
  )
$

== 极端策略

#block(
  height: 11em,
  columns()[
    - 策略1：一步到位
      - 输入代价
        - $u[0] = -1$
        - $u[1] = 0$
      - 最终代价
        - $x[1] = 0, x[2] = 0$
        - $J = 1$
    - 策略2：两步走
      - 输入代价
        - $u[0] = -0.5$
        - $u[1] = -0.5$
      - 最终代价
        - $x[1] = 0.5, x[2] = 0$
        - $J = 0.875$
  ],
)

== 最优策略

即，求$u^*[0], u^*[1]$，使$J$最小，采用逆向分级方法

- $k = 1→2$

$
  J_(1→2) &= 1 / 2 x^2[2] + 1 / 2 x^2[1] + 1 / 2 u^2[1]\
  &= 1 / 2 (x[1] + u[1])^2 + 1 / 2 x^2[1] + 1 / 2 u^2[1]
$

求导得

$ pdv(J_(1→2),u[1]) = x[1] + u[1] + u[1] = 0 $

有

$ u^*[1] = -1 / 2 x[1] $

于是

$ J^*_(1→2) = 3 / 4 x^2[1] $

进而得

$ J_(0→2) = J_(1→2) + 1 / 2(x^2[0] + u^2[0]) $

根据 Bellman 最优理论，若$J_(0→2)$最小，则子项$J_(1→2)$此时必为 最小。代入$J^*_(1→2)$和$x[1]$，可得

$ J_(0→2) = 3 / 4 (x[0] + u[0])^2 + 1 / 2 (x^2[0] + u^2[0]) $

求导得

$ pdv(J_(0→2),u[0]) = 3 / 2 (x[0] + u[0]) + u[0] = 0 $

此时

$ u^*[0] = -3 / 5 x[0] $

回代得

$ x[0] = 2 / 5, x[1] = 1 / 5 $

最终得

$ J_(min) = 0.8 $

= 线性二次型调节器

== 线性系统

对离散线性系统

$ 𝒙[k+1] = 𝑨 𝒙[k] + 𝑩 𝒖[k] $

其代价函数可化为二次型

$ J = underbrace(1 / 2(𝒙[N] - 𝒙[d])^(⊤) 𝑺(𝒙[N] - 𝒙[d]), "末端代价") + 1 / 2∑_(k=0)^(N-1) $
